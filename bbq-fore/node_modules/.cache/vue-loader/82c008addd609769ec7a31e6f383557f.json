{"remainingRequest":"D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\src\\views\\PostsDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\src\\views\\PostsDetail.vue","mtime":1665743271637},{"path":"D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665485281075},{"path":"D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1665485280411},{"path":"D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665485281075},{"path":"D:\\项目\\bbq1\\new_bbq_code\\bbq-fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1665485285948}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBsaW5rIH0gZnJvbSAnZnMnOw0KaW1wb3J0ICdnaXRodWItbWFya2Rvd24tY3NzJw0KaW1wb3J0IHsgY29sb24gfSBmcm9tICdtYXJrZG93bi1pdC9saWIvY29tbW9uL2VudGl0aWVzJzsNCmltcG9ydCBIZWFkZXIgZnJvbSAiLi4vY29tcG9uZW50cy9IZWFkZXIiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJQb3N0c0RldGFpbCIsDQogIGNvbXBvbmVudHM6IHsgSGVhZGVyIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHBvc3Q6IHsNCiAgICAgICAgaWQ6ICIiLA0KICAgICAgICB0aXRsZTogIiIsDQogICAgICAgIG1hcmtkb3duQ29udGVudDogIiIsDQogICAgICAgIGF1dGhvck5hbWU6ICcnLA0KICAgICAgICBhdXRob3JJZDogJycsDQogICAgICAgIHR5cGU6ICIiLA0KICAgICAgfSwNCiAgICAgIG93bkJsb2c6IGZhbHNlLA0KICAgICAgaXNDbGljazpmYWxzZSwNCiAgICAgIGhhc0xvZ2luOiBmYWxzZQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHRvRWRpdCgpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogJ1Bvc3RzSW5kZXhFZGl0JywgcGFyYW1zOiB7IHBvc3RJZDogdGhpcy5wb3N0LmlkIH0gfSkNCiAgICB9LA0KICAgIHRvRGVsZXRlKCkgew0KICAgICAgdGhpcy4kYXhpb3MuZGVsZXRlKCcvcG9zdHMvaW5kZXgvZGVsZXRlJywge3BhcmFtczoge3Bvc3RJZDogdGhpcy5wb3N0LmlkfX0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMjAwKSB7DQogICAgICAgICAgY29uc29sZS5sb2cocmVzKQ0KICAgICAgICAgICAgdGhpcy4kYWxlcnQoJ2RlbGV0ZSBzdWNjZXNzZnVsJywgJ25vdGljZScsIHsNCiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdPSycsDQogICAgICAgICAgICAgIGNhbGxiYWNrOiBhY3Rpb24gPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lIDogJ1Bvc3RzSW5kZXgnfSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfWVsc2Ugew0KICAgICAgICAgIHRoaXMuJGFsZXJ0KCdkZWxldGUgZmFpbGVkJykNCiAgICAgICAgfQ0KICAgICAgICBjb25zb2xlLmxvZyhyZXMpDQogICAgICB9KQ0KICAgIH0sDQogICAgYXBwcm92YWxzKCkgew0KICAgICAgaWYgKHRoaXMuaXNDbGljaykgew0KICAgICAgICB0aGlzLiRheGlvcy5nZXQoJy9wb3N0cy9pbmRleC9hcHByb3ZhbD9wb3N0SWQ9JyArIHRoaXMucG9zdC5pZCArICcmdXNlcklkPScgKyB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFVzZXIuaWQgKyImY2xpY2s9IiArIDEpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLmlzQ2xpY2sgPSBmYWxzZTsNCiAgICAgICAgICB0aGlzLiRhbGVydCgnYXBwcm92YWwgc3VjY2Vzc2Z1bCcpDQogICAgICAgIH0pDQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgdGhpcy4kYXhpb3MuZ2V0KCcvcG9zdHMvaW5kZXgvYXBwcm92YWw/cG9zdElkPScgKyB0aGlzLnBvc3QuaWQgKyAnJnVzZXJJZD0nICsgdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRVc2VyLmlkICsgIiZjbGljaz0iICsgMCkudGhlbihyZXMgPT4gew0KICAgICAgICAgIHRoaXMuaXNDbGljayA9IHRydWU7DQogICAgICAgICAgdGhpcy4kYWxlcnQoJ2FwcHJvdmFsIHN1Y2Nlc3NmdWwnKQ0KICAgICAgICB9KQ0KICAgICAgfQ0KDQoNCiAgICB9LA0KICAgIGZvbGxvdyhhdXRob3JJZCkgew0KICAgICAgdGhpcy4kYXhpb3MuZ2V0KCcvZm9sbG93L2FkZD9hdXRob3JJZD0nICsgYXV0aG9ySWQsIHsNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICJBdXRob3JpemF0aW9uIjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIikNCiAgICAgICAgfQ0KICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAyMDApIHsNCiAgICAgICAgICB0aGlzLiRhbGVydCgnZm9sbG93IHN1Y2Nlc3NmdWwnLCAnbm90aWNlJywgew0KICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ09LJywNCiAgICAgICAgICAgICAgY2FsbGJhY2s6IGFjdGlvbiA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKDApDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICB1bmZvbGxvdyhhdXRob3JJZCkgew0KICAgICAgdGhpcy4kYXhpb3MuZGVsZXRlKCcvZm9sbG93L2RlbGV0ZScsIHsNCiAgICAgICAgcGFyYW1zOiB7YXV0aG9ySWQgOiBhdXRob3JJZH0sDQogICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpDQogICAgICAgIH0NCiAgICAgIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMjAwKSB7DQogICAgICAgICAgdGhpcy4kYWxlcnQoJ3VuZm9sbG93IHN1Y2Nlc3NmdWwnLCAnbm90aWNlJywgew0KICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ09LJywNCiAgICAgICAgICAgICAgY2FsbGJhY2s6IGFjdGlvbiA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKDApDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIGNvbnN0IHBvc3RJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5wb3N0SWQNCiAgICBjb25zb2xlLmxvZyhwb3N0SWQpDQogICAgY29uc3QgX3RoaXMgPSB0aGlzDQogICAgdGhpcy4kYXhpb3MuZ2V0KCcvcG9zdHMvaW5kZXgvJyArIHBvc3RJZCkudGhlbihyZXMgPT4gew0KICAgICAgY29uc3QgcG9zdCA9IHJlcy5kYXRhLmRhdGENCiAgICAgIF90aGlzLnBvc3QuaWQgPSBwb3N0LmlkDQogICAgICBfdGhpcy5wb3N0LnRpdGxlID0gcG9zdC50aXRsZQ0KICAgICAgX3RoaXMucG9zdC5hcHByb3ZhbHMgPSBwb3N0LmFwcHJvdmFscw0KICAgICAgX3RoaXMucG9zdC5hdXRob3JOYW1lID0gcG9zdC5hdXRob3JOYW1lDQogICAgICBfdGhpcy5wb3N0LmF1dGhvcklkID0gcG9zdC5hdXRob3JJZA0KICAgICAgX3RoaXMucG9zdC5pc0ZvbGxvdyA9IHBvc3QuaXNGb2xsb3cNCiAgICAgIF90aGlzLnBvc3QudHlwZSA9IHBvc3QudHlwZQ0KICAgICAgX3RoaXMucG9zdC50b3AgPSBwb3N0LnRvcA0KICAgICAgX3RoaXMucG9zdC5tYXJyb3cgPSBwb3N0Lm1hcnJvdw0KICAgICAgX3RoaXMucG9zdC5vZmZpY2lhbCA9IHBvc3Qub2ZmaWNpYWwNCg0KICAgICAgdmFyIE1hcmRvd25JdCA9IHJlcXVpcmUoIm1hcmtkb3duLWl0IikNCiAgICAgIHZhciBtZCA9IG5ldyBNYXJkb3duSXQoKQ0KDQogICAgICB2YXIgcmVzdWx0ID0gbWQucmVuZGVyKHBvc3QubWFya2Rvd25Db250ZW50KQ0KICAgICAgX3RoaXMucG9zdC5tYXJrZG93bkNvbnRlbnQgPSByZXN1bHQNCiAgICAgIF90aGlzLm93bkJsb2cgPSAocG9zdC5hdXRob3JJZCA9PT0gX3RoaXMuJHN0b3JlLmdldHRlcnMuZ2V0VXNlci5pZCkNCg0KICAgIH0pDQogICAgdGhpcy4kYXhpb3MuZ2V0KCcvcG9zdHMvaW5kZXgvdmlld3M/cG9zdElkPScgKyAgcG9zdElkKQ0KICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFVzZXIuaWQpIHsNCiAgICAgIHRoaXMuaGFzTG9naW4gPSB0cnVlDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["PostsDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PostsDetail.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <Header></Header>\r\n    <div>\r\n\r\n      <p style=\"font-size: 30px; font-weight:700;text-align: center\">{{ post.title }}\r\n      </p >\r\n\r\n      <p style=\"font-size: 15px;text-align: right; \"> <el-tag>{{ post.type }}</el-tag>\r\n      </p >\r\n      <el-tag size=\"mini\" type=\"success\" v-show=\"post.top==1\">top</el-tag>\r\n      <el-tag size=\"mini\" type=\"success\" v-show=\"post.marrow==1\">hot</el-tag>\r\n      <el-tag size=\"mini\" type=\"success\" v-show=\"post.official==1\">official</el-tag>\r\n      <p>\r\n        <el-button icon=\"el-icon-edit\" v-if=\"ownBlog\" @click=\"toEdit()\" type=\"primary\">edit</el-button>\r\n        <el-button icon=\"el-icon-edit\" v-if=\"ownBlog\" @click=\"toDelete()\" type=\"primary\">delete</el-button>\r\n      </p >\r\n    </div>\r\n    <div style=\"text-align: center; margin-left: 20px;\" @click=\"approvals()\">\r\n      <span class=\"el-icon-user\">{{post.authorName}}\r\n        <el-button @click=\"follow(post.authorId)\" v-if=\"!ownBlog && hasLogin\" round size=\"small\">Follow author</el-button>\r\n        <el-button @click=\"unfollow(post.authorId)\" v-if=\"!ownBlog && hasLogin\" round size=\"small\">UnFollow author</el-button>\r\n      </span>\r\n    </div>\r\n    <div class=\"mblog\">\r\n      <el-divider></el-divider>\r\n      <div class=\"markdown-body\" v-html=\"post.markdownContent\"></div>\r\n    </div>\r\n\r\n    <div style=\"text-align: right; margin-right: 20px;\" @click=\"approvals()\">\r\n      <span class=\"el-icon-thumb\" />\r\n</div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport { link } from 'fs';\r\nimport 'github-markdown-css'\r\nimport { colon } from 'markdown-it/lib/common/entities';\r\nimport Header from \"../components/Header\";\r\n\r\nexport default {\r\n  name: \"PostsDetail\",\r\n  components: { Header },\r\n  data() {\r\n    return {\r\n      post: {\r\n        id: \"\",\r\n        title: \"\",\r\n        markdownContent: \"\",\r\n        authorName: '',\r\n        authorId: '',\r\n        type: \"\",\r\n      },\r\n      ownBlog: false,\r\n      isClick:false,\r\n      hasLogin: false\r\n    }\r\n  },\r\n  methods: {\r\n    toEdit() {\r\n      this.$router.push({ name: 'PostsIndexEdit', params: { postId: this.post.id } })\r\n    },\r\n    toDelete() {\r\n      this.$axios.delete('/posts/index/delete', {params: {postId: this.post.id}}).then(res => {\r\n        if (res.data.code == 200) {\r\n          console.log(res)\r\n            this.$alert('delete successful', 'notice', {\r\n              confirmButtonText: 'OK',\r\n              callback: action => {\r\n                this.$router.push({name : 'PostsIndex'})\r\n              }\r\n            })\r\n        }else {\r\n          this.$alert('delete failed')\r\n        }\r\n        console.log(res)\r\n      })\r\n    },\r\n    approvals() {\r\n      if (this.isClick) {\r\n        this.$axios.get('/posts/index/approval?postId=' + this.post.id + '&userId=' + this.$store.getters.getUser.id +\"&click=\" + 1).then(res => {\r\n          this.isClick = false;\r\n          this.$alert('approval successful')\r\n        })\r\n      }\r\n      else {\r\n        this.$axios.get('/posts/index/approval?postId=' + this.post.id + '&userId=' + this.$store.getters.getUser.id + \"&click=\" + 0).then(res => {\r\n          this.isClick = true;\r\n          this.$alert('approval successful')\r\n        })\r\n      }\r\n\r\n\r\n    },\r\n    follow(authorId) {\r\n      this.$axios.get('/follow/add?authorId=' + authorId, {\r\n        headers: {\r\n          \"Authorization\": localStorage.getItem(\"token\")\r\n        }\r\n      }).then(res => {\r\n        if (res.data.code == 200) {\r\n          this.$alert('follow successful', 'notice', {\r\n              confirmButtonText: 'OK',\r\n              callback: action => {\r\n                this.$router.go(0)\r\n              }\r\n            })\r\n        }\r\n      })\r\n    },\r\n    unfollow(authorId) {\r\n      this.$axios.delete('/follow/delete', {\r\n        params: {authorId : authorId},\r\n        headers: {\r\n          \"Authorization\": localStorage.getItem(\"token\")\r\n        }\r\n      }).then(res => {\r\n        if (res.data.code == 200) {\r\n          this.$alert('unfollow successful', 'notice', {\r\n              confirmButtonText: 'OK',\r\n              callback: action => {\r\n                this.$router.go(0)\r\n              }\r\n            })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    const postId = this.$route.params.postId\r\n    console.log(postId)\r\n    const _this = this\r\n    this.$axios.get('/posts/index/' + postId).then(res => {\r\n      const post = res.data.data\r\n      _this.post.id = post.id\r\n      _this.post.title = post.title\r\n      _this.post.approvals = post.approvals\r\n      _this.post.authorName = post.authorName\r\n      _this.post.authorId = post.authorId\r\n      _this.post.isFollow = post.isFollow\r\n      _this.post.type = post.type\r\n      _this.post.top = post.top\r\n      _this.post.marrow = post.marrow\r\n      _this.post.official = post.official\r\n\r\n      var MardownIt = require(\"markdown-it\")\r\n      var md = new MardownIt()\r\n\r\n      var result = md.render(post.markdownContent)\r\n      _this.post.markdownContent = result\r\n      _this.ownBlog = (post.authorId === _this.$store.getters.getUser.id)\r\n\r\n    })\r\n    this.$axios.get('/posts/index/views?postId=' +  postId)\r\n    if (this.$store.getters.getUser.id) {\r\n      this.hasLogin = true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.mblog {\r\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n  width: 100%;\r\n  min-height: 700px;\r\n  padding: 20px 15px;\r\n}\r\n\r\n.edit {\r\n  margin-left: 700px;\r\n}\r\n</style>"]}]}